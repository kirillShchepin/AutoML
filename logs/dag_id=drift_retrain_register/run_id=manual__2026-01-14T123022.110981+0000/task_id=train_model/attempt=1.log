[2026-01-14T12:30:32.038+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: drift_retrain_register.train_model manual__2026-01-14T12:30:22.110981+00:00 [queued]>
[2026-01-14T12:30:32.048+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: drift_retrain_register.train_model manual__2026-01-14T12:30:22.110981+00:00 [queued]>
[2026-01-14T12:30:32.049+0000] {taskinstance.py:1361} INFO - Starting attempt 1 of 1
[2026-01-14T12:30:32.061+0000] {taskinstance.py:1382} INFO - Executing <Task(BashOperator): train_model> on 2026-01-14 12:30:22.110981+00:00
[2026-01-14T12:30:32.068+0000] {standard_task_runner.py:57} INFO - Started process 272 to run task
[2026-01-14T12:30:32.071+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'drift_retrain_register', 'train_model', 'manual__2026-01-14T12:30:22.110981+00:00', '--job-id', '35', '--raw', '--subdir', 'DAGS_FOLDER/drift_retrain_register_dag.py', '--cfg-path', '/tmp/tmpk93hl3r4']
[2026-01-14T12:30:32.073+0000] {standard_task_runner.py:85} INFO - Job 35: Subtask train_model
[2026-01-14T12:30:32.132+0000] {task_command.py:416} INFO - Running <TaskInstance: drift_retrain_register.train_model manual__2026-01-14T12:30:22.110981+00:00 [running]> on host 1e681e1b2422
[2026-01-14T12:30:32.209+0000] {taskinstance.py:1662} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='drift_retrain_register' AIRFLOW_CTX_TASK_ID='train_model' AIRFLOW_CTX_EXECUTION_DATE='2026-01-14T12:30:22.110981+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2026-01-14T12:30:22.110981+00:00'
[2026-01-14T12:30:32.210+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2026-01-14T12:30:32.211+0000] {subprocess.py:75} INFO - Running command: ['/bin/bash', '-c', 'python /opt/***/scripts/train_pycaret.py']
[2026-01-14T12:30:32.224+0000] {subprocess.py:86} INFO - Output:
[2026-01-14T12:30:39.101+0000] {subprocess.py:93} INFO - 2026/01/14 12:30:39 WARNING mlflow.utils.git_utils: Failed to import Git (the Git executable is probably not on your PATH), so Git SHA is not available. Error: Failed to initialize: Bad git executable.
[2026-01-14T12:30:39.101+0000] {subprocess.py:93} INFO - The git executable must be specified in one of the following ways:
[2026-01-14T12:30:39.101+0000] {subprocess.py:93} INFO -     - be included in your $PATH
[2026-01-14T12:30:39.102+0000] {subprocess.py:93} INFO -     - be set via $GIT_PYTHON_GIT_EXECUTABLE
[2026-01-14T12:30:39.102+0000] {subprocess.py:93} INFO -     - explicitly set via git.refresh(<full-path-to-git-executable>)
[2026-01-14T12:30:39.102+0000] {subprocess.py:93} INFO - 
[2026-01-14T12:30:39.103+0000] {subprocess.py:93} INFO - All git commands will error until this is rectified.
[2026-01-14T12:30:39.103+0000] {subprocess.py:93} INFO - 
[2026-01-14T12:30:39.103+0000] {subprocess.py:93} INFO - This initial message can be silenced or aggravated in the future by setting the
[2026-01-14T12:30:39.103+0000] {subprocess.py:93} INFO - $GIT_PYTHON_REFRESH environment variable. Use one of the following values:
[2026-01-14T12:30:39.104+0000] {subprocess.py:93} INFO -     - quiet|q|silence|s|silent|none|n|0: for no message or exception
[2026-01-14T12:30:39.104+0000] {subprocess.py:93} INFO -     - warn|w|warning|log|l|1: for a warning message (logging level CRITICAL, displayed by default)
[2026-01-14T12:30:39.104+0000] {subprocess.py:93} INFO -     - error|e|exception|raise|r|2: for a raised exception
[2026-01-14T12:30:39.104+0000] {subprocess.py:93} INFO - 
[2026-01-14T12:30:39.105+0000] {subprocess.py:93} INFO - Example:
[2026-01-14T12:30:39.105+0000] {subprocess.py:93} INFO -     export GIT_PYTHON_REFRESH=quiet
[2026-01-14T12:30:39.105+0000] {subprocess.py:93} INFO - 
[2026-01-14T12:30:39.618+0000] {subprocess.py:93} INFO - stage=setup start
[2026-01-14T12:30:39.619+0000] {subprocess.py:93} INFO -                     Description            Value
[2026-01-14T12:30:39.619+0000] {subprocess.py:93} INFO - 0                    Session id               42
[2026-01-14T12:30:39.620+0000] {subprocess.py:93} INFO - 1                        Target            price
[2026-01-14T12:30:39.620+0000] {subprocess.py:93} INFO - 2                   Target type       Regression
[2026-01-14T12:30:39.620+0000] {subprocess.py:93} INFO - 3           Original data shape      (53940, 10)
[2026-01-14T12:30:39.620+0000] {subprocess.py:93} INFO - 4        Transformed data shape      (53940, 27)
[2026-01-14T12:30:39.621+0000] {subprocess.py:93} INFO - 5   Transformed train set shape      (37758, 27)
[2026-01-14T12:30:39.621+0000] {subprocess.py:93} INFO - 6    Transformed test set shape      (16182, 27)
[2026-01-14T12:30:39.621+0000] {subprocess.py:93} INFO - 7              Numeric features                6
[2026-01-14T12:30:39.622+0000] {subprocess.py:93} INFO - 8          Categorical features                3
[2026-01-14T12:30:39.622+0000] {subprocess.py:93} INFO - 9                    Preprocess             True
[2026-01-14T12:30:39.622+0000] {subprocess.py:93} INFO - 10              Imputation type           simple
[2026-01-14T12:30:39.622+0000] {subprocess.py:93} INFO - 11           Numeric imputation             mean
[2026-01-14T12:30:39.623+0000] {subprocess.py:93} INFO - 12       Categorical imputation             mode
[2026-01-14T12:30:39.623+0000] {subprocess.py:93} INFO - 13     Maximum one-hot encoding               25
[2026-01-14T12:30:39.623+0000] {subprocess.py:93} INFO - 14              Encoding method             None
[2026-01-14T12:30:39.624+0000] {subprocess.py:93} INFO - 15               Fold Generator            KFold
[2026-01-14T12:30:39.624+0000] {subprocess.py:93} INFO - 16                  Fold Number                3
[2026-01-14T12:30:39.624+0000] {subprocess.py:93} INFO - 17                     CPU Jobs               -1
[2026-01-14T12:30:39.624+0000] {subprocess.py:93} INFO - 18                      Use GPU            False
[2026-01-14T12:30:39.624+0000] {subprocess.py:93} INFO - 19               Log Experiment     MlflowLogger
[2026-01-14T12:30:39.625+0000] {subprocess.py:93} INFO - 20              Experiment Name  diamonds_automl
[2026-01-14T12:30:39.625+0000] {subprocess.py:93} INFO - 21                          USI             978c
[2026-01-14T12:30:39.625+0000] {subprocess.py:93} INFO - stage=setup done seconds=3
[2026-01-14T12:30:39.626+0000] {subprocess.py:93} INFO - stage=compare_models start
[2026-01-14T12:36:26.765+0000] {subprocess.py:93} INFO - Processing:   0%|          | 0/77 [00:00<?, ?it/s]Processing:   6%|▋         | 5/77 [00:03<00:53,  1.34it/s]Processing:   9%|▉         | 7/77 [00:03<00:35,  1.99it/s]Processing:  12%|█▏        | 9/77 [00:06<00:53,  1.27it/s]Processing:  14%|█▍        | 11/77 [00:06<00:36,  1.82it/s]Processing:  17%|█▋        | 13/77 [00:08<00:46,  1.36it/s]Processing:  19%|█▉        | 15/77 [00:09<00:32,  1.90it/s]Processing:  22%|██▏       | 17/77 [00:11<00:43,  1.39it/s]Processing:  25%|██▍       | 19/77 [00:11<00:30,  1.92it/s]Processing:  27%|██▋       | 21/77 [00:11<00:22,  2.54it/s]Processing:  30%|██▉       | 23/77 [00:11<00:15,  3.39it/s]Processing:  32%|███▏      | 25/77 [00:12<00:12,  4.20it/s]Processing:  35%|███▌      | 27/77 [00:12<00:09,  5.38it/s]Processing:  38%|███▊      | 29/77 [00:12<00:07,  6.18it/s]Processing:  40%|████      | 31/77 [00:12<00:06,  7.51it/s]Processing:  43%|████▎     | 33/77 [00:12<00:05,  7.77it/s]Processing:  45%|████▌     | 35/77 [00:12<00:04,  9.11it/s]Processing:  48%|████▊     | 37/77 [00:13<00:05,  6.71it/s]Processing:  51%|█████     | 39/77 [00:13<00:04,  8.04it/s]Processing:  53%|█████▎    | 41/77 [00:14<00:07,  4.97it/s]Processing:  56%|█████▌    | 43/77 [00:14<00:05,  6.11it/s]Processing:  58%|█████▊    | 45/77 [00:16<00:11,  2.76it/s]Processing:  61%|██████    | 47/77 [00:16<00:08,  3.65it/s]Processing:  64%|██████▎   | 49/77 [00:16<00:06,  4.08it/s]Processing:  66%|██████▌   | 51/77 [00:16<00:04,  5.22it/s]Processing:  69%|██████▉   | 53/77 [00:20<00:15,  1.55it/s]Processing:  71%|███████▏  | 55/77 [00:20<00:10,  2.13it/s]Processing:  74%|███████▍  | 57/77 [00:22<00:14,  1.39it/s]Processing:  77%|███████▋  | 59/77 [00:22<00:09,  1.91it/s]Processing:  79%|███████▉  | 61/77 [00:24<00:10,  1.57it/s]Processing:  82%|████████▏ | 63/77 [00:24<00:06,  2.14it/s]Processing:  84%|████████▍ | 65/77 [00:27<00:09,  1.33it/s]Processing:  87%|████████▋ | 67/77 [00:27<00:05,  1.83it/s]Processing:  90%|████████▉ | 69/77 [05:32<06:08, 46.01s/it]Processing:  92%|█████████▏| 71/77 [05:32<03:13, 32.23s/it]Processing:  95%|█████████▍| 73/77 [05:32<01:30, 22.63s/it]Processing:  97%|█████████▋| 75/77 [05:32<00:31, 15.88s/it]Processing: 100%|██████████| 77/77 [05:36<00:00, 11.66s/it]                                                                                               Model        MAE           MSE  \
[2026-01-14T12:36:26.766+0000] {subprocess.py:93} INFO - lightgbm  Light Gradient Boosting Machine   292.7961  3.165640e+05
[2026-01-14T12:36:26.766+0000] {subprocess.py:93} INFO - et                  Extra Trees Regressor   282.3485  3.287453e+05
[2026-01-14T12:36:26.767+0000] {subprocess.py:93} INFO - rf                Random Forest Regressor   284.4921  3.367000e+05
[2026-01-14T12:36:26.767+0000] {subprocess.py:93} INFO - gbr           Gradient Boosting Regressor   409.5639  5.584540e+05
[2026-01-14T12:36:26.767+0000] {subprocess.py:93} INFO - dt                Decision Tree Regressor   377.2702  5.907948e+05
[2026-01-14T12:36:26.768+0000] {subprocess.py:93} INFO - knn                 K Neighbors Regressor   554.5845  1.067619e+06
[2026-01-14T12:36:26.768+0000] {subprocess.py:93} INFO - lasso                    Lasso Regression   745.6345  1.294562e+06
[2026-01-14T12:36:26.768+0000] {subprocess.py:93} INFO - llar         Lasso Least Angle Regression   745.6518  1.295292e+06
[2026-01-14T12:36:26.769+0000] {subprocess.py:93} INFO - ridge                    Ridge Regression   748.7299  1.361974e+06
[2026-01-14T12:36:26.769+0000] {subprocess.py:93} INFO - br                         Bayesian Ridge   748.4364  1.365790e+06
[2026-01-14T12:36:26.769+0000] {subprocess.py:93} INFO - lr                      Linear Regression   748.3693  1.366714e+06
[2026-01-14T12:36:26.770+0000] {subprocess.py:93} INFO - huber                     Huber Regressor   847.2610  1.703162e+06
[2026-01-14T12:36:26.770+0000] {subprocess.py:93} INFO - par          Passive Aggressive Regressor   877.6245  1.745070e+06
[2026-01-14T12:36:26.770+0000] {subprocess.py:93} INFO - ada                    AdaBoost Regressor  1048.6964  2.009900e+06
[2026-01-14T12:36:26.771+0000] {subprocess.py:93} INFO - omp           Orthogonal Matching Pursuit  1365.5124  3.482693e+06
[2026-01-14T12:36:26.771+0000] {subprocess.py:93} INFO - en                            Elastic Net  1231.2390  3.527896e+06
[2026-01-14T12:36:26.771+0000] {subprocess.py:93} INFO - dummy                     Dummy Regressor  3043.2319  1.602737e+07
[2026-01-14T12:36:26.772+0000] {subprocess.py:93} INFO - lar                Least Angle Regression  2253.1910  1.040033e+09
[2026-01-14T12:36:26.772+0000] {subprocess.py:93} INFO - 
[2026-01-14T12:36:26.772+0000] {subprocess.py:93} INFO -                 RMSE       R2   RMSLE    MAPE  TT (Sec)
[2026-01-14T12:36:26.772+0000] {subprocess.py:93} INFO - lightgbm    562.4035   0.9802  0.1120  0.0857  101.4000
[2026-01-14T12:36:26.773+0000] {subprocess.py:93} INFO - et          573.2453   0.9795  0.0968  0.0701    0.8667
[2026-01-14T12:36:26.773+0000] {subprocess.py:93} INFO - rf          579.9871   0.9790  0.0965  0.0696    1.1300
[2026-01-14T12:36:26.773+0000] {subprocess.py:93} INFO - gbr         747.1243   0.9652  0.2171  0.1300    0.9467
[2026-01-14T12:36:26.774+0000] {subprocess.py:93} INFO - dt          768.5252   0.9631  0.1311  0.0910    0.1167
[2026-01-14T12:36:26.774+0000] {subprocess.py:93} INFO - knn        1033.2319   0.9334  0.1997  0.1556    0.5500
[2026-01-14T12:36:26.774+0000] {subprocess.py:93} INFO - lasso      1137.7434   0.9192  0.5848  0.3902    0.8867
[2026-01-14T12:36:26.774+0000] {subprocess.py:93} INFO - llar       1138.0597   0.9192  0.5842  0.3902    0.0700
[2026-01-14T12:36:26.775+0000] {subprocess.py:93} INFO - ridge      1165.9578   0.9150  0.5845  0.3946    0.7467
[2026-01-14T12:36:26.775+0000] {subprocess.py:93} INFO - br         1167.4984   0.9148  0.5829  0.3945    0.0767
[2026-01-14T12:36:26.775+0000] {subprocess.py:93} INFO - lr         1167.8705   0.9147  0.5836  0.3945    1.2367
[2026-01-14T12:36:26.776+0000] {subprocess.py:93} INFO - huber      1304.5295   0.8937  0.6559  0.4485    0.2533
[2026-01-14T12:36:26.776+0000] {subprocess.py:93} INFO - par        1314.9027   0.8913  0.8110  0.5799    0.1600
[2026-01-14T12:36:26.776+0000] {subprocess.py:93} INFO - ada        1417.3008   0.8746  0.4141  0.4428    0.6033
[2026-01-14T12:36:26.777+0000] {subprocess.py:93} INFO - omp        1866.1294   0.7827  0.7710  0.6655    0.0700
[2026-01-14T12:36:26.777+0000] {subprocess.py:93} INFO - en         1877.9058   0.7799  0.6704  0.4588    0.7667
[2026-01-14T12:36:26.790+0000] {subprocess.py:93} INFO - dummy      4003.3708  -0.0001  1.1288  1.8875    0.1567
[2026-01-14T12:36:26.794+0000] {subprocess.py:93} INFO - lar       19894.6002 -63.6946  0.8918  1.1995    0.0667
[2026-01-14T12:36:26.799+0000] {subprocess.py:93} INFO - stage=compare_models done seconds=347
[2026-01-14T12:36:26.799+0000] {subprocess.py:93} INFO - stage=finalize_model start
[2026-01-14T12:36:26.800+0000] {subprocess.py:93} INFO - stage=finalize_model done seconds=350
[2026-01-14T12:36:26.800+0000] {subprocess.py:93} INFO - stage=predict_model start
[2026-01-14T12:36:26.800+0000] {subprocess.py:93} INFO -                              Model       MAE        MSE  ...      R2   RMSLE    MAPE
[2026-01-14T12:36:26.801+0000] {subprocess.py:93} INFO - 0  Light Gradient Boosting Machine  285.8573  282684.85  ...  0.9819  0.1075  0.0832
[2026-01-14T12:36:26.801+0000] {subprocess.py:93} INFO - 
[2026-01-14T12:36:26.802+0000] {subprocess.py:93} INFO - [1 rows x 7 columns]
[2026-01-14T12:36:26.803+0000] {subprocess.py:93} INFO - stage=predict_model done seconds=350
[2026-01-14T12:36:26.803+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2026-01-14T12:36:26.804+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3802, in get_loc
[2026-01-14T12:36:26.804+0000] {subprocess.py:93} INFO -     return self._engine.get_loc(casted_key)
[2026-01-14T12:36:26.804+0000] {subprocess.py:93} INFO -   File "pandas/_libs/index.pyx", line 138, in pandas._libs.index.IndexEngine.get_loc
[2026-01-14T12:36:26.805+0000] {subprocess.py:93} INFO -   File "pandas/_libs/index.pyx", line 165, in pandas._libs.index.IndexEngine.get_loc
[2026-01-14T12:36:26.805+0000] {subprocess.py:93} INFO -   File "pandas/_libs/hashtable_class_helper.pxi", line 5745, in pandas._libs.hashtable.PyObjectHashTable.get_item
[2026-01-14T12:36:26.805+0000] {subprocess.py:93} INFO -   File "pandas/_libs/hashtable_class_helper.pxi", line 5753, in pandas._libs.hashtable.PyObjectHashTable.get_item
[2026-01-14T12:36:26.806+0000] {subprocess.py:93} INFO - KeyError: 'Label'
[2026-01-14T12:36:26.806+0000] {subprocess.py:93} INFO - 
[2026-01-14T12:36:26.806+0000] {subprocess.py:93} INFO - The above exception was the direct cause of the following exception:
[2026-01-14T12:36:26.807+0000] {subprocess.py:93} INFO - 
[2026-01-14T12:36:26.807+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2026-01-14T12:36:26.807+0000] {subprocess.py:93} INFO -   File "/opt/***/scripts/train_pycaret.py", line 100, in <module>
[2026-01-14T12:36:26.810+0000] {subprocess.py:93} INFO - 
[2026-01-14T12:36:26.811+0000] {subprocess.py:93} INFO -   File "/opt/***/scripts/train_pycaret.py", line 68, in main
[2026-01-14T12:36:26.811+0000] {subprocess.py:93} INFO -     print(f"stage=predict_model done seconds={int(time.time() - start_time)}")
[2026-01-14T12:36:26.812+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/pandas/core/frame.py", line 3807, in __getitem__
[2026-01-14T12:36:26.812+0000] {subprocess.py:93} INFO -     indexer = self.columns.get_loc(key)
[2026-01-14T12:36:26.812+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3804, in get_loc
[2026-01-14T12:36:26.813+0000] {subprocess.py:93} INFO -     raise KeyError(key) from err
[2026-01-14T12:36:26.818+0000] {subprocess.py:93} INFO - KeyError: 'Label'
[2026-01-14T12:36:27.990+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2026-01-14T12:36:28.005+0000] {taskinstance.py:1937} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 210, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2026-01-14T12:36:28.009+0000] {taskinstance.py:1400} INFO - Marking task as FAILED. dag_id=drift_retrain_register, task_id=train_model, execution_date=20260114T123022, start_date=20260114T123032, end_date=20260114T123628
[2026-01-14T12:36:28.028+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 35 for task train_model (Bash command failed. The command returned a non-zero exit code 1.; 272)
[2026-01-14T12:36:28.062+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2026-01-14T12:36:28.086+0000] {taskinstance.py:2778} INFO - 0 downstream tasks scheduled from follow-on schedule check
